---
title: 全息图稳定性
description: HoloLens 自动稳定全息，但开发人员可以采取的措施来提高进一步全息图稳定性。
author: thetuvix
ms.author: alexturn
ms.date: 03/21/2018
ms.topic: article
keywords: 全息，稳定性 hololens
ms.openlocfilehash: b35b904e3c662c5ebd0670a98044706fe208e348
ms.sourcegitcommit: c20563b8195c0c374a927b96708d958b127ffc8f
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 05/21/2019
ms.locfileid: "65974940"
---
# <a name="hologram-stability"></a>全息图稳定性

若要实现稳定全息，HoloLens 具有内置映像稳定管道。 稳定管道自动在后台的工作，因此无需启用它的额外步骤。 但是，开发人员应执行提高全息图稳定性的技术并避免降低稳定性的方案。

## <a name="hologram-quality-terminology"></a>全息图质量术语

全息的质量是好的环境和良好的应用程序开发的结果。 命中常量 60 帧 / 秒，HoloLens 用来跟踪周围环境的环境中的应用程序将确保全息图和匹配的坐标系统保持同步。从用户的角度来看，为了保持静止的全息不会移动环境。

当环境问题时，不一致或较低的呈现速率或其他应用程序问题出现，下列术语很有帮助确定问题。
* **准确性。** 一旦全息图是世界上锁定并放置在现实生活中，它应保留它已放置的位置，相对于周围的环境，独立于用户动作或小型和稀疏环境的变化。 如果一张全息图更高版本中的意外位置出现，它是*准确性*问题。 如果两个不同的房间外观看起来相同，则可能发生这种情况。
* **抖动。** 用户将观察这作为高频率摇动的一张全息图。 这可以降低环境的跟踪。 对于用户，该解决方案运行[传感器优化](sensor-tuning.md)。
* **Judder。** 低呈现频率会导致不均匀的动作和全息的双精度映像。 这是在与运动全息会尤为明显。 开发人员需要维护[常量 60 FPS](hologram-stability.md#frame-rate)。
* **偏移。** 用户看到此和全息图显示将从最初下达移开的。 发生这种情况时从远放置全息[空间的定位点](spatial-anchors.md)，尤其是在尚未完全映射的环境部分。 创建空间的定位点接近全息降低偏差的可能性。
* **Jumpiness。** 当一张全息图"弹出"或者"跳转"离开其位置偶尔。 这可能因为跟踪调整全息以匹配已更新您的环境的了解。
* **Swim.** 当一张全息图看起来 sway 对应于用户的 head 的动作。 发生这种情况是当不在全息[稳定平面](hologram-stability.md#stabilization-plane)，和如果 HoloLens 不[校准](calibration.md)为当前用户。 用户可以重新运行[校准](calibration.md)应用程序若要解决此问题。 开发人员可以更新要进一步增强稳定性的稳定平面。
* **分色。** HoloLens 中的显示信息是颜色的顺序显示，该闪存的红绿蓝绿色颜色通道，60 赫兹 （单个颜色字段的显示位置将 240 Hz）。 每当用户跟踪具有其自己的眼睛移动全息图，该 hologram 前导和尾随边缘分隔以其构成的颜色，从而产生出喷薄彩虹效果效果。 一定程度的分离所依赖的 hologram 速度。 在某些罕见的情况下，移动的头部快速时查看静态全息图也可能导致出喷薄彩虹效果。 这称为 *[颜色分离](hologram-stability.md#color-separation)* 。

## <a name="frame-rate"></a>帧速率

帧速率是全息图稳定性的第一个支柱。 对于全息才会出现在世界稳定，向用户显示每个映像必须在正确的位置绘制全息。 HoloLens 刷新每秒 240 次显示，其中四个独立的色彩字段显示为每个新呈现图像，从而导致 60 FPS （帧 / 秒） 的用户体验。 若要提供最佳体验，应用程序开发人员必须保留 60 FPS，这会转换为一致地提供对操作系统的新映像每隔 16 毫秒。

**60 FPS**绘制全息来看起来像坐在现实生活中，HoloLens 需要呈现来自用户的位置的图像。 图像呈现所需时间，因为 HoloLens 预测时图像所示显示中用户的头将在其中。 此预测算法是一个近似值。 HoloLens 具有调整到帐户的预测的头位置和实际头位置之间的差异进行呈现的图像的硬件。 这使映像用户会看到显示像它已从正确的位置，从呈现和全息感觉稳定。 映像更新的工作最适合具有较小的更改和无法完全修复等动作视差呈现的图像中的某些内容。

通过在 60 FPS 呈现，你正在以使稳定全息的三个操作：
1. 最大程度减少呈现图像和用户看到该映像之间的总体延迟。 在使用游戏线程和呈现线程引擎保持同步，在 30 FPS 运行运行可以添加额外延迟 33.3ms。 通过减少延迟，这会降低预测错误，并增大全息图稳定性。
2. 从而使每个图像到达用户的眼球具有一致的延迟时间。 如果呈现在每秒 30 帧，显示仍在 60 FPS 显示图像。 这意味着同一图像将显示在一行中两次。 第二个帧将具有 16.6ms 比第一个延迟时间更长的帧，但将不得不更正读作更多数量的错误。 在错误数量级这种不一致性会导致不需要 60 hz judder。
3. 减少 judder 的外观，其中的特征是不均匀的动作和 double 的映像。 更快的 hologram 运动，呈现较低费率都与得更明显 judder。 因此，努力保持 60 FPS 根本时间将有助于避免 judder 为给定的移动全息图。

**帧速率一致性**帧速率一致性是与高帧 / 秒时一样重要。 偶尔会丢弃帧是不可避免地存在的任何内容丰富的应用程序，并 HoloLens 实现一些复杂的算法来从临时故障中恢复。 但是，不断波动的帧速率是用户以较低的帧速率一致地运行应用程序相比更明显。 例如，呈现顺利 5 帧 (这些 5 个帧的持续时间为 60 FPS)，然后删除接下来的 10 帧 (这些 10 帧的持续时间为 30 FPS) 的所有其他框架的应用程序将显示比应用程序更不稳定的一致在每秒 30 帧的呈现。

请注意，在操作系统将限制下每秒 30 帧的应用程序时[混合现实捕获](mixed-reality-capture.md)正在运行。

**性能分析**有多种可用于应用程序帧速率等进行基准测试的工具：
* GPUView
* Visual Studio 图形调试器
* 例如 Unity 3D 引擎中内置的探查器

## <a name="hologram-render-distances"></a>全息图呈现距离

>[!VIDEO https://www.youtube.com/embed/-606oZKLa_s]

人工 visual 系统集成多个依赖于距离的信号时它 fixates，重点放在一个对象。
* [便利设施](https://en.wikipedia.org/wiki/Accommodation_%28eye%29)-单个关注的焦点。
* [聚合](https://en.wikipedia.org/wiki/Convergence_(eye))-两只眼睛，开始向内移动或向外，在中心对象。
* [放大镜视觉](https://en.wikipedia.org/wiki/Stereopsis)-依赖于对象的距离的位置固定点的左侧和右侧眼映像之间的不一致。
* 明暗度、 相对 angular 大小和其他 monocular （单个眼睛） 提示。

聚合和便利设施是唯一，因为它们是如何更改眼睛感知不同距离处的对象与相关的额外视网膜提示。 在自然查看链接聚合和便利设施。 当眼睛查看内容 （例如你鼻子） 附近时眼睛跨和适应 near 点。 当在无穷大的眼睛就会变得并行和关注眼睛查看的内容适合于为无穷大。 戴上 HoloLens 的用户将始终允许到 2.0 m 来维护清晰的图像因为 HoloLens 显示固定为光学的距离大约 2.0 m 背朝用户。 通过将内容和全息放置在各种深入探索聚合用户的眼睛，其中应用开发人员控制。 当用户适应，并集中到不同的距离时的两个提示之间的自然链接已断开，这可能会导致 visual 不适或疲劳，尤其是在冲突的量很大。 从 vergence 便利设施冲突不适可以避免或最小化通过保留 2.0 m 尽可能接近收敛到用户的内容 （即具有深度的很多场景中放入 2.0 m 尽可能接近的感兴趣的区域）。 不能放置内容时从 vergence 方便起见冲突的近 2.0 m 不适是最大时用户的注视来回之间距离各不相同。 换而言之，它是更舒适地看一下静态 hologram 保持 50 cm 消失比若要查看一张全息图 50 cm 消失，随着时间的推移将靠近或远离你。

因为两个显示专为在此距离完全重叠，将内容放在 2.0 m 还有更有利。 对于映像关闭此平面放置，随着 holographic 帧消失它们将消失从同时仍显示在另一个监视器。 此放大镜 rivalry 可能会造成干扰的 hologram 深度公众形象。

**将用户从全息的最佳距离**

![将用户从全息的最佳距离](images/distanceguiderendering-750px.png)

**修剪平面**建议的最大舒适处使用的内容开始 1 百万 fadeout 85 cm 剪辑呈现距离。 在其中全息和用户是两个静态全息的应用程序中可以查看可几乎为 50 cm。 在这些情况下，应用程序应不超过 30 cm 更接近放置剪裁平面和淡出应开始在至少 10 个 cm 离开剪裁平面。 每当内容是比 85 cm 务必要确保用户不经常移动更近或远离全息或，全息不经常移动更近或远离用户最有可能会导致从不适允许这种情况下进行更接近vergence 便利设施，发生冲突。 内容应旨在最大程度减少交互更接近比 85 cm 用户，但必须进一步超过 85 cm 面向开发人员良好经验法则是设计的方案的用户和/或全息请不要移动在超过 25 %t 的深度中呈现内容时需要他时间。

**最佳做法**全息不能放在 2 分钟，不能避免聚合和便利设施之间的冲突，全息图放置的最佳区域时，1.25 m 和 5 分钟之间。 设计器应在所有情况下，结构内容鼓励用户交互 1 + 米的位置 （例如调整内容大小和默认的位置参数）。

## <a name="stabilization-plane"></a>稳定平面
> [!NOTE]
> 对于桌面的沉浸式耳机，设置稳定平面。 通常使系统效率降低，因为它提供了比能够提供应用程序的系统，以使每个像素深度基于 reprojection 深度缓冲区更少视觉质量 除非在 HoloLens 上运行，通常应避免设置稳定平面。

HoloLens 执行复杂的硬件辅助的 holographic 稳定技术。 这会很大程度上自动，并且需要遵守动作和更改的角度来看 (CameraPose)，如场景进行动画处理，并且用户将其头。 选择单个平面，名为稳定平面，若要最大化此稳定。 所有全息场景中的都接收某些稳定，全息稳定平面中的可以都获得最大硬件稳定性的做法。

![稳定平面的三维对象](images/stab-plane-500px.jpg)

设备将自动尝试选择此平面，但应用程序可以通过选择场景中的焦点位置协助此过程。 HoloLens 上运行的 unity 应用应选择最佳关注点根据您的场景，并将其传递到[SetFocusPoint()](focus-point-in-unity.md)。 在 DirectX 中设置的焦点位置的示例包括在默认旋转多维数据集模板中。

请注意，Unity 应用上运行时连接到桌面 PC 沉浸式头戴式耳机，Unity 将提交到 Windows，若要启用每个像素 reprojection，通常会由应用程序提供更好的图像质量，而无需显式工作深度缓冲区。 如果提供焦点，将重写每个像素 reprojection，因此您应该仅这样做时在 HoloLens 上运行你的应用。




```cs
// SetFocusPoint informs the system about a specific point in your scene to
// prioritize for image stabilization. The focus point is set independently
// for each holographic camera.
// You should set the focus point near the content that the user is looking at.
// In this example, we put the focus point at the center of the sample hologram,
// since that is the only hologram available for the user to focus on.
// You can also set the relative velocity and facing of that content; the sample
// hologram is at a fixed point so we only need to indicate its position.
renderingParameters.SetFocusPoint(
    currentCoordinateSystem,
    spinningCubeRenderer.Position
    );
```

很大程度上取决于焦点的位置查看全息图。 该应用程序可以引用的视线移动矢量和应用程序设计器知道哪些内容他们想要观察的用户。

开发人员可以如何稳定全息的单个最重要一点是以 60 FPS 呈现。 正在删除以下 60 FPS 会极大地降低全息图稳定性，而不考虑稳定平面优化。

**最佳做法**没有通用方法来设置稳定平面，它是特定于应用的因此主要建议是试验，创造最适合你的方案。 但是，尝试尽可能对齐包含太多内容的稳定平面，因为此平面上的所有内容已完全都稳定化。

例如：
* 如果必须对齐用平面的稳定平面仅平面内容 （阅读应用程序，视频播放应用程序），具有你的内容。
* 如果有 3 个小的球形是世界上锁定，使"剪切"的稳定平面，尽管所有球体的中心位于当前用户的视图。
* 如果您的场景于差别很大的深度中包含的内容，进一步选择对象。
* 请确保调整查看每个帧，以便与用户的全息图保持一致的稳定点

**请避免对**稳定平面是一个不错工具以实现稳定全息，但如果误用它可能会导致严重的映像不稳定。
* 没有"发后不理"，因为您可能会产生稳定性的做法背后用户平面或附加到一个对象，它不能再在用户的视图。 请确保正常的稳定平面设置相反的照相机进 (例如-camera.forward)
* 不，快速更改极端之间来回的稳定平面
* 不要将设置为固定的距离/方向的稳定平面
* 不要让用户通过剪切的稳定平面
* 不在 PC 而不是 HoloLens，台式机上运行时设置的焦点位置，而是依靠每像素的深度基于 reprojection。

## <a name="color-separation"></a>分色 

由于 HoloLens 显示的特性，可能有时会被称为"分色"的项目。 它表现为分成单个基本颜色的红色、 绿色和蓝色的图像。 因为它们具有大量的红色、 绿色和蓝色显示白色对象时，项目可以是尤为明显。 在用户直观地跟踪一张全息图时最为明显的是移动跨高速全息版的帧。 项目可以清单的另一种方法是对象的/扭曲变形。 如果对象具有高对比度和/或纯颜色 （红色、 绿色、 蓝色） 颜色分离将会被视为扭曲的对象的不同部分。

**如用户旋转在端对其头，哪些颜色分离的 head 锁定白色圆形游标的示例可能如下：**

![哪些颜色分离的 head 锁定白色圆形游标的示例可能类似于如用户旋转在端对其头。](images/colorseparationofroundwhitecursor-300px.png)

尽管很难完全避免分色，有几种方法可用来缓解此问题。

**可以上看到分色：**
* 要移动速度快，如包括 head 锁定对象的对象[游标](cursors.md)。
* 对象的大体上远[稳定平面](hologram-stability.md#stabilization-plane)。

**若要会分色的效果：**
* 请延隔用户的视线移动的对象。 看起来应该像它具有一些延时和"上弹簧"附加到的视线移动。 这将减慢光标 （减少分离距离），并将其放在用户的可能的视线移动点后面。 只要它快速赶上当用户停止转移其提供注视感觉非常自然。
* 如果确实想要移动一张全息图，请尝试保持它的移动速度下面 5 度/秒，如果你希望用户将遵循它与自己眼。
* 使用*light*而不是*geometry*光标。 附加到的视线移动虚拟照明的源将被视为非交互式的指针，但不是会导致分色。
* 调整以匹配在观望用户全息的稳定平面。
* 使对象 red、 green 或 blue。
* 切换到内容的经过模糊处理版本。 例如，倒圆角的白色游标可能是面向移动的方向的略有经过模糊处理行的更改。

如之前，呈现在 60 FPS 和设置的稳定平面是全息图稳定性的最重要技术。 如果出现明显颜色分离，首先请确保帧速率满足的期望。

## <a name="see-also"></a>请参阅
* [混合现实的了解性能](understanding-performance-for-mixed-reality.md)
* [颜色、光线和材料](color,-light-and-materials.md)
* [本能交互](interaction-fundamentals.md)