---
title: 空间定位点
description: 使用空间定位点呈现稳定全息影像的最佳做法。
author: thetuvix
ms.author: alexturn
ms.date: 02/24/2019
ms.topic: article
ms.localizationpriority: high
keywords: 坐标系、空间坐标系、世界规模、世界、规模、位置、方向、定位点、空间定位点、世界锁定、持久性、共享
ms.openlocfilehash: 16165194d040ad22f7885897eddcc65cf9dcaec3
ms.sourcegitcommit: f20beea6a539d04e1d1fc98116f7601137eebebe
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 06/05/2019
ms.locfileid: "65730853"
---
# <a name="spatial-anchors"></a>空间定位点

空间定位点表示系统应随时间跟踪的世界上的重要点。 每个定位点具有可根据需要进行调整的[坐标系](coordinate-systems.md)（相对于其他定位点或参照系），以确保锚定的全息影像保持位置精确。  在定位点的坐标系中呈现全息影像可以在任何给定时间为你提供最准确的全息影像定位。 这是以不断对全息影像的位置进行小的调整为代价的，因为系统不断地将其移回到相对于现实世界的位置。

还可以跨应用会话和跨设备持久保存和共享空间定位点：
* 通过将局部空间定位点保存到磁盘并稍后重新加载这些定位点，应用可以在单个 HoloLens 设备上的多个应用会话中推断现实世界中的相同位置。
* 通过使用 <a href="https://docs.microsoft.com/azure/spatial-anchors/overview" target="_blank">Azure 空间定位点</a>创建云定位点，应用可以跨多个 HoloLens、iOS 和 Android 设备共享空间定位点。 通过使每个设备使用相同的空间定位点呈现全息影像，所有用户将看到全息影像显示在现实世界中的相同位置。  这可实现实时共享体验。
* 还可以使用 <a href="https://docs.microsoft.com/azure/spatial-anchors/overview" target="_blank">Azure 空间定位点</a>在 HoloLens、iOS 和 Android 设备上实现异步全息影像持久性。  通过共享持久的云空间定位点，多个设备可以随着时间推移观察相同的持久全息影像，即使这些设备没有同时出现，也是如此。

对于保持在直径 5 米以内的固定的桌面头戴显示设备，如果想要获得站立范围或房间范围的体验，通常只需使用[状态参照系](coordinate-systems.md#stage-frame-of-reference)（而不是空间定位点），它可以提供用于呈现所有内容的单一坐标系。 但是，如果应用希望让用户在 HoloLens 上漫步超过 5 米（也许在建筑物的某一个楼层中漫步），你需要使用空间定位点来保持内容稳定。

虽然空间定位点非常适合应该在世界中保持固定的全息影像，但是放置定位点后，它便无法移动。 除了定位点，还有其他更适合动态全息影像的选择，应该与用户一起标记。 最好使用固定的参照系（Unity 世界坐标的基础）或附加的参照系来定位动态全息影像。

## <a name="best-practices"></a>最佳做法

这些空间定位点指南将帮助你呈现稳定的全息影像，准确跟踪现实世界。

### <a name="create-spatial-anchors-where-users-place-them"></a>在用户需要放置空间定位点的位置创建空间定位点

大多数情况下，应该由用户明确放置空间定位点。

例如，在 HoloLens 上，应用可以让用户的[凝视](gaze.md)线与[空间映射](spatial-mapping.md)网格相交，让用户确定放置全息影像的位置。 当用户通过点击放置全息影像时，在交叉点创建空间定位点，然后将全息影像放置在该定位点坐标系的原点。

局部空间定位点的创建简单且高效，如果多个定位点可以共享其底层传感器数据，系统将合并其内部数据。 通常应为用户明确放置的每个全息影像创建一个新的局部空间定位点，但下面列出的情况除外，例如固定的全息影像组。

### <a name="always-render-anchored-holograms-within-3-meters-of-their-anchor"></a>始终呈现定位点 3 米范围内的锚定的全息影像

空间定位点稳定定位点原点附近的坐标系。 如果呈现的全息影像距离原点约 3 米以上，由于杠杆效应，这些全息影像可能会出现与它们距离原点的距离成比例的明显位置误差。 如果用户站在定位点附近，这种方法是有效的，因为全息影像也离用户较远，这意味着远的全息影像的角度误差将较小。 然而，如果用户走向远处的全息影像，它会在他们的视野中变大，这使得远处定位点原点的杠杆效应非常明显。

### <a name="group-holograms-that-should-form-a-rigid-cluster"></a>聚集应形成固定群集的全息影像

如果应用希望这些全息影像彼此保持固定的关系，那么多个全息影像可以使用同一个空间定位点。

例如，如果你在房间里制作一个全息太阳系动画，最好将所有太阳系对象绑定到中心的单个定位点，这样它们就可以相对流畅地移动。 在这种情况下，太阳系作为一个整体被锚定，即使其组成部分围绕定位点动态移动，也是如此。

保持全息影像稳定性的关键点是遵循上面的 3 米规则。

### <a name="render-highly-dynamic-holograms-using-the-stationary-frame-of-reference-instead-of-a-local-spatial-anchor"></a>使用固定参照系（而不是局部空间定位点）呈现高度动态全息影像

如果具有高度动态全息影像（例如在房间内走动的角色，或沿着用户附近的墙壁浮动的 UI），最好跳过局部空间定位点并直接在[固定参照系](coordinate-systems.md#stationary-frame-of-reference)提供的坐标系中呈现这些全息影像（即在 Unity 中，可以通过将全息影像直接放置在没有 WorldAnchor 的世界坐标中来实现此目的）。 当用户远离全息影像时，静止参照系中的全息影像可能会发生漂移，但这对于动态全息影像来说不太可能是明显的：要么全息影像一直在移动，要么它的移动一直使它靠近用户，在这种情况下漂移就会最大限度减小。

动态全息影像的一个有趣的例子是创建从一个锚定坐标系到另一个锚定坐标系的动画的对象。 例如，有两座相距 10 米的城堡，每座城堡都有自己的空间定位点，其中一座城堡向另一座城堡发射炮弹。 当炮弹发射时，你可以在固定参照系的适当位置呈现它，以便与第一座城堡的锚定坐标系中的大炮保持一致。 然后，它可以循着它在固定参照系中的轨迹，在空中飞行 10 米。 当炮弹到达另一座城堡时，可以选择将它移动到第二座城堡的锚定坐标系中，以便对该城堡的刚体进行物理计算。

如果跨设备共享高度动态全息影像，则需要选择一些云空间定位点充当其父级，因为不能跨设备共享固定参照系。  但是，在这种情况下，应该确保动态全息影像或观察它的设备保持在定位点的 3 米半径范围内，以确保全息影像在所有设备上看起来都是稳定的。

### <a name="avoid-creating-a-grid-of-spatial-anchors"></a>避免创建空间定位点网格

你可能想要在用户四处移动时让应用放置空间定位点的常规网格，在用户移动时将动态对象从一个定位点转移到另一个定位点。 但是，这涉及到对应用的大量管理，而没有系统本身内部维护的深度传感器数据的好处。 对于这些情况，通常可以通过将全息影像放置在固定的参照系中，以较少的工作量获得更好的结果，如上一节所述。

当在静态空间周围预先定位一组云空间定位点时，请考虑按照上述原则将空间定位点放置在用户将遇到的关键全息影像的位置，而不是创建一个任意的定位点网格。  该操作可确保获得这些关键全息影像的最大稳定性。

### <a name="release-local-spatial-anchors-you-no-longer-need"></a>释放你不再需要的局部空间定位点

当局部空间定位点处于活动状态时，系统将优先处理靠近该定位点的传感器数据。 如果你不再使用空间定位点，请停止访问其坐标系。 这将允许根据需要移除其底层传感器数据。

这对于你持久保存到空间定位点存储的局部定位点尤其重要。 这些定位点后的传感器数据将永久保留，以便应用在将来的应用会话中找到该定位点，这将减少用于跟踪其他定位点的空间。 在将来的会话中仅保留你需要再次查找的局部定位点，并在它们对用户不再有意义时将其从存储中删除。

对于云空间定位点，存储可以根据场景需要进行扩展。  可以根据需要存储尽可能多的云定位点，仅当你知道用户不需要再次在该定位点上定位全息影像时才释放它们。

## <a name="see-also"></a>另请参阅
* [坐标系统](coordinate-systems.md)
* [混合现实中的共享体验](shared-experiences-in-mixed-reality.md)
* <a href="https://docs.microsoft.com/azure/spatial-anchors" target="_blank">Azure 空间定位点</a>
* [Unity 中的持久性](persistence-in-unity.md)
* [DirectX 中的空间定位点](coordinate-systems-in-directx.md#place-holograms-in-the-world-using-spatial-anchors)
* [案例研究 - 看透现实中的洞](case-study-looking-through-holes-in-your-reality.md)
